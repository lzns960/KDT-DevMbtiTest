const mongoClient = require('../mongoConnect');
const _client = mongoClient.connect();

/* ì´ˆê¸° ìƒíƒœ ì„¤ì • */
const initState = {
  mbtiResult: '',
  page: 0, // 0: ì¸íŠ¸ë¡œ íŽ˜ì´ì§€, 1 ~ n: ì„ íƒ íŽ˜ì´ì§€, n+1: ê²°ê³¼ íŽ˜ì´ì§€
  // ì§ˆë¬¸ ëª©ë¡
  survey: [
    {
      question:
        'í‡´ê·¼ ì§ì „ì— ë™ë£Œë¡œë¶€í„° ê°œë°œìž ëª¨ìž„ì— ì´ˆëŒ€ë¥¼ ë°›ì€ ë‚˜!\n\ní‡´ê·¼ ì‹œê°„ì— ë‚˜ëŠ”?',
      answer: [
        {
          text: 'ê·¸ëŸ° ëª¨ìž…ì„ ì™œ ì´ì œì„œì•¼ ì•Œë ¤ ì¤€ê±°ì•¼! \në‹¹ìž¥ ëª¨ìž„ìœ¼ë¡œ ì¶œë°œí•œë‹¤',
          result: 'E',
        },
        {
          text: '1ë…„ ì „ì— ì•Œë ¤ì¤¬ì–´ë„ ì•ˆê°”ì„ ê±´ë° ë­”...\në” ë¹ ë¥´ê²Œ ì§‘ìœ¼ë¡œ ê°„ë‹¤',
          result: 'I',
        },
      ],
    },
    {
      question:
        'ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ê°œë°œ ì¤‘ì—, ë™ë£Œê°€ ìƒˆë¡œ ë‚˜ì˜¨ ì‹ ê¸°ìˆ ì„ ì“°ëŠ”ê²Œ ë” íŽ¸í• ê±°ë¼ê³  ì¶”ì²œì„ í•´ì¤€ë‹¤!\n\në‚˜ì˜ ì„ íƒì€!?',
      answer: [
        {
          text: 'ë­”ì†Œë¦¬ì—¬, ê·¸ëƒ¥ í•˜ë˜ ëŒ€ë¡œ ê°œë°œí•˜ë©´ ë˜ëŠ”ê±°ì§€! ê¸°ì¡´ ìƒê°ëŒ€ë¡œ ê°œë°œí•œë‹¤',
          result: 'S',
        },
        {
          text: 'ì˜¤í˜¸? ê·¸ëŸ°ê²Œ ìžˆì–´? ì¼ë‹¨ êµ¬ê¸€ì„ ì°¾ì•„ë³¸ë‹¤',
          result: 'N',
        },
      ],
    },
    {
      question:
        'ì„œë¹„ìŠ¤ ì¶œì‹œ ì´í‹€ ì „ ì•¼ê·¼ ì‹œê°„, ê°‘ìžê¸° ë™ë£Œê°€ ì–´!? ë¥¼ ì™¸ì³¤ë‹¤!\n\në‚˜ì˜ ì„ íƒì€?',
      answer: [
        {
          text: 'ë¬´ìŠ¨ ë²„ê·¸ê°€ ë°œìƒí•œ ê±°ì§€? ì•„ë§ˆ DB ê´€ë ¨ ë²„ê·¸ê°€ ì•„ë‹ê¹Œ? \në¹ ë¥´ê²Œ ë™ë£Œì˜ ìžë¦¬ë¡œ ë‹¬ë ¤ê°„ë‹¤',
          result: 'T',
        },
        {
          text: 'ì•„... ë‚´ì¼ë„ ì•¼ê·¼ ê°ì´êµ¬ë‚˜ ã… ã… ! \nì¼ë‹¨ ë™ë£Œì˜ ìžë¦¬ë¡œ ê°€ ë³¸ë‹¤',
          result: 'F',
        },
      ],
    },
    {
      question:
        'íŒ€ìž¥ë‹˜ì´ xxì”¨ ê·¸ì „ì— ë§í•œ ê¸°ëŠ¥ ë‚´ì¼ ì˜¤í›„ê¹Œì§€ ì™„ë£Œ ë¶€íƒí•´ìš”ë¼ê³  ë§í–ˆë‹¤!\n\në‚˜ì˜ ì„ íƒì€?',
      answer: [
        {
          text: 'ì¼ë‹¨ ë¹ ë¥´ê²Œ ê°œë°œ ì™„ë£Œí•˜ê³ , \në‚˜ë¨¸ì§€ ì‹œê°„ì— ë…¼ë‹¤',
          result: 'J',
        },
        {
          text: 'ë‚´ì¼ ì•„ì¹¨ì— ì™€ì„œ ê°œë°œí•´ë„ ì¶©ë¶„ í•˜ê² ëŠ”ë°? \nì¼ë‹¨ ë…¼ë‹¤',
          result: 'P',
        },
      ],
    },
  ],
  //ê²°ê³¼ì— ëŒ€í•œ ì„¤ëª…
  explanation: {
    ESTJ: {
      text: 'ë¬´ë¦¬í•œ ê°œë°œ ì¼ì •ë§Œ ì•„ë‹ˆë¼ë©´ ì¼ì •ì„ ì² ì €í•˜ê²Œ ì§€í‚¬ ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/estj.png',
      emoji: 'ðŸ”ª + â˜• + ðŸ“ƒ',
      subText: 'ì¹¼ ê°™ì€ ì„±ê²©, ë¼ë–¼ëŠ” ë§ì´ì•¼, ì² ì €í•œ ê³„íš ì£¼ì˜ìž',
    },
    ISTJ: {
      text: 'ìŠ¤ìŠ¤ë¡œ í•˜ê³ ì‹¶ì€ ë¶„ì•¼ë¥¼ ëê¹Œì§€ íŒŒê³  ë“¤ì–´ì„œ ëë‚´ ì„±ê³µ ì‹œí‚¬ ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/istj.png',
      emoji: 'âœ + ðŸ¤– + ðŸ§',
      subText: 'ê³„íšëŒ€ë¡œ í–‰ë™í•˜ê³  ì•„ë¶€ë¥¼ ëª»í•˜ê³  í˜¼ìžê°€ íŽ¸í•¨',
    },
    ENTJ: {
      text: 'ë¯¸ëž˜ì˜ ëŠ¥ë ¥ ì©ŒëŠ” ê°œë°œ íŒ€ìž¥ë‹˜ìœ¼ë¡œ ê°œë°œíŒ€ì„ ì´ëŒ ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/entj.png',
      emoji: 'ðŸ‘©â€ðŸ« + ðŸƒâ€â™‚ + ðŸ“´',
      subText: 'ì´ëŒì–´ë‚´ê³  ì§„ë‘ì§€íœ˜í•˜ì§€ë§Œ ë‚¨í•œí…Œ ê´€ì‹¬ NOPE',
    },
    INTJ: {
      text: 'í˜¼ìžì„œ ëª¨ë“  ê²ƒì„ ë‹¤ í•´ë‚´ëŠ” ì›ë§¨ ìºë¦¬ì˜ í‘œë³¸! ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/intj.png',
      emoji: 'ðŸŽ¯ + ðŸ” + ðŸŽ¢',
      subText: 'í•˜ë‚˜ ê½‚ížˆë©´ ê·¸ê²ƒë§Œ íŒŒê³  í…ì…˜ì´ ì™”ë‹¤ê°”ë‹¤ í•¨',
    },
    ESFJ: {
      text: 'ê°œë°œíŒ€ì˜ ë¶„ìœ„ê¸° ë©”ì´ì»¤ì´ìž ì•„ì´ë””ì–´ ë±…í¬ê°€ ë  ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/esfj.png',
      emoji: 'ðŸ‘‘ + ðŸ“‘ + ðŸ‘¼',
      subText: 'ê°íˆ¬ì“°ê¸°, ê³„íš ì„¸ìš°ê¸°, ë‚¨ ë„ì™€ì£¼ê¸°ë¥¼ ì¢‹ì•„í•¨',
    },
    ISFJ: {
      text: 'ê°œë°œíŒ€ì˜ ë§ˆë” í…Œë ˆì‚¬, ê³ ë¯¼ ìƒë‹´ì†Œ ì—­í• ì„ ìžì²˜í•˜ëŠ” ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/isfj.png',
      emoji: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ + ðŸ’• + ðŸŽ­',
      subText: 'ì‚¬ëžŒì„ ì¢‹ì•„í•˜ê³  ë°°ë ¤í•˜ê³  ì†ë§ˆìŒì„ í‹°ë¥¼ ì•ˆ ëƒ„',
    },
    ENFJ: {
      text: 'ë‹¹ì‹ ì´ ìžˆëŠ” íŒ€ì€ ì–¸ì œë‚˜ ì˜¬ë°”ë¥¸ ê³³ì„ í–¥í•˜ê³  ìžˆìŠµë‹ˆë‹¤! íŒ€ì›ì€ ë¬¼ë¡  íŒ€ì˜ ë°©í–¥ì„ ì±™ê¸°ëŠ” ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/enfj.png',
      emoji: 'âœ¨ + ðŸ’¸ + ðŸ’ž',
      subText: 'ì •ì˜ë¡­ê³  í‰í™”ë¡œì›€ì„ ì¤‘ì‹œí•˜ë©° ë‹¤ í¼ì£¼ëŠ”st',
    },
    INFJ: {
      text: 'ì˜ˆë¦¬í•œ í†µì°°ë ¥ìœ¼ë¡œ ëª¨ë“  ê²ƒì„ ë‚´ë‹¤ë³´ë©´ì„œ ì™„ë²½í•˜ê²Œ ê°œë°œì„ í•  ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/infj.png',
      emoji: 'ðŸ¤ + ðŸŒ· + ðŸ”­',
      subText: 'ê°ìˆ˜ì„±, ê³µê° ëŠ¥ë ¥ì´ í’ë¶€í•˜ë©´ íƒìƒ‰í•˜ëŠ” ê±¸ ì¢‹ì•„í•¨',
    },
    ESTP: {
      text: 'ì¿¨í•˜ê²Œ ìžì‹ ì´ í•  ê²ƒì„ í•˜ë©´ì„œ ë…¼ë¦¬ì ì¸ ê°œë°œì„ í•  ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/estp.png',
      emoji: 'ðŸ˜ˆ + ðŸ”¥ + ðŸŽ¤',
      subText: 'í™”ëˆí•˜ê³  ë’¤ë ì—†ê³  ë§ì€ ìž˜í•˜ëŠ”ë° ë§íˆ¬ê°€ ì…ˆ',
    },
    ISTP: {
      text: 'ë‹¨ì‹œê°„ì—ë„ íš¨ìœ¨ì ìœ¼ë¡œ ê°œë°œí•˜ì—¬ ëª¨ë“  ê²ƒì„ ì™„ì„±í•  ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/istp.png',
      emoji: 'ðŸ¤· + ðŸ‘Œ + ðŸ”«',
      subText: 'ì–´ì©Œë¼ê³  ë§ˆì¸ë“œ, ê°„ê²°í•œ ê²Œ ìµœê³ , ì„  ë„˜ìœ¼ë©´ ì£½ìž„',
    },
    ENTP: {
      text: 'ìŠ¤ìŠ¤ë¡œ í¥ë¯¸ë§Œ ìƒê¸´ë‹¤ë©´ ë‹¹ìž¥ì— íŽ˜ì´ìŠ¤ë¶ë„ ë§Œë“¤ì–´ ë²„ë¦´ ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/entp.png',
      emoji: 'ðŸ¤´ + ðŸ“¢ + ðŸƒ',
      subText: 'ë‚´ê°€ ì œì¼ ìž˜ë‚˜ê°€ê³  í° ëª©ì†Œë¦¬ì— ìž¥ë‚œì„ ì¢‹ì•„í•¨',
    },
    INTP: {
      text: 'í™•ì‹¤í•œ ì£¼ê´€ê³¼ ë›°ì–´ë‚œ ì§€ëŠ¥ì„ ë°”íƒ•ìœ¼ë¡œ ë…¼ë¦¬ì  ê°œë°œì„ í•  ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/intp.png',
      emoji: 'ðŸ“š + ðŸ”¬ + ðŸŽŠ',
      subText: 'ê·€ì°®ì§€ë§Œ ì±…ì„ ì¢‹ì•„í•˜ë©° ê´€ì‹¬ë¶„ì•¼ì—ì„œë§Œ ë°œì–¸ í„°ì§',
    },
    ESFP: {
      text: 'ê°œë°œíŒ€ì˜ ì—ë„ˆìžì´ì €! ê°œë°œíŒ€ íŠ¹ìœ ì˜ ì„œë¨¹í•¨ì„ ê¹¨ëŠ” ë‹¹ì‹ ! ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/esfp.png',
      emoji: 'ðŸŽ‰ + ðŸ¾ + ðŸ’ƒ',
      subText: 'í•˜ê³  ì‹¶ì€ ê±´ ë‹¤ í•´ì•¼ í•˜ë©° ì–¸ì œë‚˜ íŒŒí‹° ë§ˆì¸ë“œ',
    },
    ISFP: {
      text: 'ë›°ì–´ë‚œ í˜¸ê¸°ì‹¬ê³¼ ì˜ˆìˆ ì  ê°ê°ìœ¼ë¡œ ê°œë°œíŒ€ì˜ ë¶€ì¡±í•¨ì„ ì±„ì›Œê°ˆ ë‹¹ì‹ ! ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/isfp.png',
      emoji: 'ðŸ  + ðŸ§¸ + ðŸ‘',
      subText: 'ì§‘ ìµœê³ , ë…¸ëŠ” ê±° ìµœê³ , ì§‘ì—ì„œ ë…¸ëŠ” ê±´ ë” ìµœê³ ',
    },
    ENFP: {
      text: 'ìžìœ ë¡œìš´ ì˜í˜¼ìœ¼ë¡œ ê°œë°œíŒ€ì˜ ìœ¤í™œìœ  ë° í™œë ¥ì†Œê°€ ë˜ì–´ì¤„ ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/enfp.png',
      emoji: 'ðŸ’© + ðŸŒˆ + ðŸŽˆ',
      subText: 'ì´ ì´ëª¨ì§€ë¥¼ í•©ì³ì„œ ì¸ê°„í™”í•˜ë©´ ENFPê°€ ë¨',
    },
    INFP: {
      text: 'ê°œë°œíŒ€ì˜ ê·¸ ì–´ë–¤ íŠ¸ëŸ¬ë¸”ë„ ë‹¹ì‹  ì•žì—ì„œëŠ” ì‚¬ë¥´ë¥´ ë…¹ì„ë¿, íŒ€ì˜ ê·¼ê°„ì„ ë‹¤ì ¸ì£¼ëŠ” ë‹¹ì‹ ì˜ MBTI ëŠ”!',
      img: '/images/infp.png',
      emoji: 'ðŸ’– + ðŸŽ  + ðŸ–¤',
      subText: 'ë™í™”ê°™ì´ ì•„ê¸°ìžê¸°í•œ ë§ˆìŒ í•˜ì§€ë§Œ ê¹Šì€ ê³³ì—” ìš°ìš¸í•¨',
    },
  },
};

const mongoDB = {
  setData: async () => {
    const client = await _client;
    const db = client.db('mbti').collection('data');
    const result = await db.insertOne(initState);
    if (result.acknowledged) {
      return 'ì—…ë°ì´íŠ¸ ì„±ê³µ';
    } else {
      throw new Error('í†µì‹ ì´ìƒ');
    }
  },

  getCounts: async () => {
    const client = await _client;
    const db = client.db('mbti').collection('counts');
    const data = await db.find({}).toArray();
    return data;
  },
  incCounts: async () => {
    const client = await _client;
    const db = client.db('mbti').collection('counts');
    const result = await db.updateOne({ id: 1 }, { $inc: { counts: +1 } });
    if (result.acknowledged) {
      return 'ì—…ë°ì´íŠ¸ ì„±ê³µ';
    } else {
      throw new Error('í†µì‹ ì´ìƒ');
    }
  },
  getData: async () => {
    const client = await _client;
    const db = client.db('mbti').collection('data');
    const data = await db.find({}).toArray();
    return data;
  },
};

module.exports = mongoDB;
